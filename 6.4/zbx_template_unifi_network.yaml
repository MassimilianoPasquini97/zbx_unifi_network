zabbix_export:
  version: '6.4'
  template_groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  host_groups:
    -
      uuid: c066ade8616c43d9acfac81bd1ef6a63
      name: Network
  templates:
    -
      uuid: 7db7c68fd7114232a2a5c5eb4e84d94f
      template: 'Unifi Network'
      name: 'Unifi Network'
      description: |
        This template use Unifi Dream Machine API for fetch data. API Wiki: https://ubntwiki.com/products/software/unifi-controller/api
        
        This macros are mandatory:
        - {$UNIFI.IP}: Unifi IP or fqdn
        - {$UNIFI.USERNAME}: Unifi username
        - {$UNIFI.PASSWORD}: Unifi password
        - {$UNIFI.API.AUTH.URI}: change if using unifi controller vm
        - {$UNIFI.API.AUTH.TOKEN}: change if using unifi controller vm
        - {$UNIFI.API.URI}: change if using unifi controller vm
        
        For security reason create a dedicated zabbix view only user on Unifi.
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: adb686720e594b6eb330a8ac21e1f97c
          name: 'API stat/sta'
          type: HTTP_AGENT
          key: unifi.client
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/sta';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
        -
          uuid: bc04da34977e44b797750e41ce55e40d
          name: 'Unifi CPU Usage %'
          type: DEPENDENT
          key: unifi.cpu
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].[''gw_system-stats''].cpu'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: cpu
          triggers:
            -
              uuid: 05eff4fc03e64c5b8652cdb1d40fb9c7
              expression: 'avg(/Unifi Network/unifi.cpu,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 8bd2279066d04957b9e064aab7c177c1
              expression: 'avg(/Unifi Network/unifi.cpu,{$UNIFI.CPU.USAGE.WARNING.SEC})>{$UNIFI.CPU.USAGE.WARNING}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
                  expression: 'avg(/Unifi Network/unifi.cpu,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
        -
          uuid: 6b791e73ffca47a8a4434668469a8c03
          name: 'API stat/device-basic'
          type: HTTP_AGENT
          key: unifi.device
          delay: 1d
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/device-basic';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
        -
          uuid: 5d034734fc2d49e59a3f3305cc6aaad7
          name: 'Unifi Name'
          type: DEPENDENT
          key: unifi.gw_name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].gw_name'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
          triggers:
            -
              uuid: 619191afb5a64f93ab918c9bf8522164
              expression: 'last(/Unifi Network/unifi.gw_name,#1:now-24h)<>last(/Unifi Network/unifi.gw_name,#1)=1'
              name: 'Hostname Changed'
              priority: WARNING
        -
          uuid: ef0672fee36f43c48d88b601a06beceb
          name: 'API stat/health'
          type: HTTP_AGENT
          key: unifi.health
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/health';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
          triggers:
            -
              uuid: 631488ad954b474dbb1ac5f87f2e731e
              expression: 'last(/Unifi Network/unifi.health,#3)=""'
              name: 'Unifi API not responding'
              priority: HIGH
        -
          uuid: 9bc9eb2def2a4bcab5555889b1f3cc03
          name: 'Unifi LAN Client'
          type: DEPENDENT
          key: unifi.lan.client
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_user'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
        -
          uuid: c2b46c301f1248a5b25b41e4592900b1
          name: 'Unifi LAN Guest Client'
          type: DEPENDENT
          key: unifi.lan.guest.client
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_guest'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
        -
          uuid: 0ff8f3e31cf44064994c4490168b1cd3
          name: 'Unifi LAN Status'
          type: DEPENDENT
          key: unifi.lan.status
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].status'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
          triggers:
            -
              uuid: 021ff8a030f944fca0df2a9f413d51b8
              expression: 'last(/Unifi Network/unifi.lan.status,#3)<>"ok" and last(/Unifi Network/unifi.lan.status,#3)<>"unknown"'
              name: 'Problem on LAN'
              priority: HIGH
        -
          uuid: dcd33070e4ad4f60b647a1961f33aca7
          name: 'Unifi LAN SW'
          type: DEPENDENT
          key: unifi.lan.sw
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_sw'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
        -
          uuid: 88d4706e92964e8c835f323b58877f08
          name: 'Unifi LAN SW Adopted'
          type: DEPENDENT
          key: unifi.lan.sw.adopted
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_adopted'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
        -
          uuid: 21c89dfcf8be483c9ea345436b521e23
          name: 'Unifi LAN SW Disconnected'
          type: DEPENDENT
          key: unifi.lan.sw.disconnected
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_disconnected'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
          triggers:
            -
              uuid: 4a94a843199a43209d28d11d4ac4fcf1
              expression: 'avg(/Unifi Network/unifi.lan.sw.disconnected,{$UNIFI.SW.DISCONNECTED.SEC})>0'
              name: 'One or more Switch is disconnected'
              priority: HIGH
        -
          uuid: ae7c7ddeb12f4fab9e99555f4e30e0de
          name: 'Unifi LAN SW Pending'
          type: DEPENDENT
          key: unifi.lan.sw.pending
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[3].num_pending'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: lan
          triggers:
            -
              uuid: ee9ab163258249f8bb835425ab9e256c
              expression: 'avg(/Unifi Network/unifi.lan.sw.pending,{$UNIFI.SW.PENDING.SEC})>0'
              name: 'One or more Switch need to be adopted'
              priority: INFO
        -
          uuid: 518344b8648e41cb95ed5f23210e609a
          name: 'Unifi Memory Usage %'
          type: DEPENDENT
          key: unifi.mem
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].[''gw_system-stats''].mem'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: memory
          triggers:
            -
              uuid: 612a2e49d50749a7a733db1635d4ca4a
              expression: 'avg(/Unifi Network/unifi.mem,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 9d3eed23e1264c8fb1dd7fcfd9f366b8
              expression: 'avg(/Unifi Network/unifi.mem,{$UNIFI.MEMORY.USAGE.WARNING.SEC})>{$UNIFI.MEMORY.USAGE.WARNING}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
                  expression: 'avg(/Unifi Network/unifi.mem,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
        -
          uuid: 19846b5f27fb4c43a2c7c9f8dea081a4
          name: 'Unifi Uptime'
          type: DEPENDENT
          key: unifi.uptime
          delay: '0'
          history: 7d
          trends: '0'
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].[''gw_system-stats''].uptime'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
          triggers:
            -
              uuid: 11074bcccecd4f34971a50329bb76f52
              expression: 'last(/Unifi Network/unifi.uptime)<86400'
              name: 'Device rebooted'
              priority: WARNING
        -
          uuid: 48e299f5945542d6b8b52df1c86bb4e4
          name: 'Unifi VPN Status'
          type: DEPENDENT
          key: unifi.vpn.status
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[4].status'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: vpn
          triggers:
            -
              uuid: 9e9cc722c7644f879abb0fd99023e2a7
              expression: 'last(/Unifi Network/unifi.vpn.status,#3)<>"ok" and last(/Unifi Network/unifi.vpn.status,#3)<>"unknown"'
              name: 'Problem on VPN'
              priority: HIGH
        -
          uuid: 2eebb9af70804a6fbd0f54dc66cecc30
          name: 'Unifi VPN Active Users'
          type: DEPENDENT
          key: unifi.vpn.users
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[4].remote_user_num_active'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: vpn
        -
          uuid: bcd72b39a9bf4f5cbe673542e4947503
          name: 'Unifi WAN ISP Availability'
          type: DEPENDENT
          key: unifi.wan.isp.availability
          delay: '0'
          history: 7d
          trends: 90d
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].uptime_stats.WAN.availability'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
        -
          uuid: 5870daa1ceea48d0bcf2b0501a6310ee
          name: 'Unifi WAN Download'
          type: DEPENDENT
          key: unifi.wan.isp.download
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: bps
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].[''rx_bytes-r'']'
            -
              type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
          triggers:
            -
              uuid: 41866be03f3f467eacd5e290870a97d1
              expression: 'avg(/Unifi Network/unifi.wan.isp.download,{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH.SEC})/10000/{$UNIFI.ISP.SPEED.DOWNLOAD}>{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH}'
              name: 'ISP Download Usage > {$UNIFI.ISP.SPEED.DOWNLOAD.HIGH}%'
              priority: HIGH
            -
              uuid: 70e48b9f22a44d0599d96bcb81ce3a70
              expression: 'avg(/Unifi Network/unifi.wan.isp.download,{$UNIFI.ISP.SPEED.DOWNLOAD.WARNING.SEC})/10000/{$UNIFI.ISP.SPEED.DOWNLOAD}>{$UNIFI.ISP.SPEED.DOWNLOAD.WARNING}'
              name: 'ISP Download Usage > {$UNIFI.ISP.SPEED.DOWNLOAD.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'ISP Download Usage > {$UNIFI.ISP.SPEED.DOWNLOAD.HIGH}%'
                  expression: 'avg(/Unifi Network/unifi.wan.isp.download,{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH.SEC})/10000/{$UNIFI.ISP.SPEED.DOWNLOAD}>{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH}'
        -
          uuid: bcef68f6cb4c4a9582ab45506552a132
          name: 'Unifi WAN ISP Latency Avg'
          type: DEPENDENT
          key: unifi.wan.isp.latency
          delay: '0'
          history: 7d
          trends: 90d
          units: ms
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].uptime_stats.WAN.latency_average'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
          triggers:
            -
              uuid: b15881dc61fb48c995c67431ef053f9b
              expression: 'avg(/Unifi Network/unifi.wan.isp.latency,{$UNIFI.ISP.LATENCY.HIGH.SEC})>{$UNIFI.ISP.LATENCY.HIGH}'
              name: 'ISP Latency Usage > {$UNIFI.ISP.LATENCY.HIGH}ms'
              priority: HIGH
            -
              uuid: f2d1e5e2a80d46a2abd7597b621e383e
              expression: 'avg(/Unifi Network/unifi.wan.isp.latency,{$UNIFI.ISP.LATENCY.WARNING.SEC})>{$UNIFI.ISP.LATENCY.WARNING}'
              name: 'ISP Latency Usage > {$UNIFI.ISP.LATENCY.WARNING}ms'
              priority: WARNING
              dependencies:
                -
                  name: 'ISP Latency Usage > {$UNIFI.ISP.LATENCY.HIGH}ms'
                  expression: 'avg(/Unifi Network/unifi.wan.isp.latency,{$UNIFI.ISP.LATENCY.HIGH.SEC})>{$UNIFI.ISP.LATENCY.HIGH}'
        -
          uuid: a9e928c4197b4e10911163c855ee3c8f
          name: 'Unifi WAN ISP Name'
          type: DEPENDENT
          key: unifi.wan.isp.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].isp_name'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
        -
          uuid: 4c46adf2a00946f1bd62165534edf5f8
          name: 'Unifi WAN ISP Organization'
          type: DEPENDENT
          key: unifi.wan.isp.organization
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].isp_organization'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
        -
          uuid: 1fb2e533375e448ab092057da508d8f7
          name: 'Unifi WAN Upload'
          type: DEPENDENT
          key: unifi.wan.isp.upload
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: bps
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].[''tx_bytes-r'']'
            -
              type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
          triggers:
            -
              uuid: a0cec212f47a4b458707bd45adf0aec7
              expression: 'avg(/Unifi Network/unifi.wan.isp.upload,{$UNIFI.ISP.SPEED.UPLOAD.HIGH.SEC})/10000/{$UNIFI.ISP.SPEED.UPLOAD}>{$UNIFI.ISP.SPEED.UPLOAD.HIGH}'
              name: 'ISP Upload Usage > {$UNIFI.ISP.SPEED.UPLOAD.HIGH}%'
              priority: HIGH
            -
              uuid: ec8126a5a5b9449895a82c9869ac9476
              expression: 'avg(/Unifi Network/unifi.wan.isp.upload,{$UNIFI.ISP.SPEED.UPLOAD.WARNING.SEC})/10000/{$UNIFI.ISP.SPEED.UPLOAD}>{$UNIFI.ISP.SPEED.UPLOAD.WARNING}'
              name: 'ISP Upload Usage > {$UNIFI.ISP.SPEED.UPLOAD.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'ISP Upload Usage > {$UNIFI.ISP.SPEED.UPLOAD.HIGH}%'
                  expression: 'avg(/Unifi Network/unifi.wan.isp.upload,{$UNIFI.ISP.SPEED.UPLOAD.HIGH.SEC})/10000/{$UNIFI.ISP.SPEED.UPLOAD}>{$UNIFI.ISP.SPEED.UPLOAD.HIGH}'
        -
          uuid: d05b9efa545a4bba93df66756c70a909
          name: 'Unifi WAN ISP Uptime'
          type: DEPENDENT
          key: unifi.wan.isp.uptime
          delay: '0'
          history: 7d
          trends: 90d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].uptime_stats.WAN.uptime'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
          triggers:
            -
              uuid: 4d89ad745ec94e6688b247198e5f24bd
              expression: 'last(/Unifi Network/unifi.wan.isp.uptime)<3600'
              name: 'ISP Uptime changed'
              priority: WARNING
        -
          uuid: c38767caeb1749c8b491cd1955cfb664
          name: 'Unifi WAN Status'
          type: DEPENDENT
          key: unifi.wan.status
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[1].status'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wan
          triggers:
            -
              uuid: 086fb12ad42b4fb6859ce34a45858a3e
              expression: 'last(/Unifi Network/unifi.wan.status,#3)<>"ok" and last(/Unifi Network/unifi.wan.status,#3)<>"unknown"'
              name: 'Problem on WAN'
              priority: HIGH
        -
          uuid: 340228b81d684eb985bfe1c1d143e709
          name: 'Unifi WLAN AP'
          type: DEPENDENT
          key: unifi.wlan.ap
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_ap'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
        -
          uuid: 52d9f16104a44be4bbcc49b66d2ee7dc
          name: 'Unifi WLAN AP Adopted'
          type: DEPENDENT
          key: unifi.wlan.ap.adopted
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_adopted'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
        -
          uuid: b707a72b4aba40b9be09e5bbb7ba56b0
          name: 'Unifi WLAN AP Disabled'
          type: DEPENDENT
          key: unifi.wlan.ap.disabled
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_disabled'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
        -
          uuid: a8fbff194c7a4991b08fdd688d545b88
          name: 'Unifi WLAN AP Disconnected'
          type: DEPENDENT
          key: unifi.wlan.ap.disconnected
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_disconnected'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
          triggers:
            -
              uuid: f3912e88b72f4fecba5f750cf76f9dd8
              expression: 'avg(/Unifi Network/unifi.wlan.ap.disconnected,{$UNIFI.AP.DISCONNECTED.SEC})>0'
              name: 'One or more Acces Point is disconnected'
              priority: HIGH
        -
          uuid: 6691b14597164df2b34dbdbe7e67cc59
          name: 'Unifi WLAN AP Pending'
          type: DEPENDENT
          key: unifi.wlan.ap.pending
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_pending'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
          triggers:
            -
              uuid: 23728a046e5348c0b55451ab33dd5f2e
              expression: 'avg(/Unifi Network/unifi.wlan.ap.pending,{$UNIFI.AP.PENDING.SEC})>0'
              name: 'One or more Access Point need to be adopted'
              priority: INFO
        -
          uuid: 6494ee43ad94448cb8bfb375cc16f577
          name: 'Unifi WLAN Client'
          type: DEPENDENT
          key: unifi.wlan.client
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_user'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
        -
          uuid: e85dea10563940c69e7e6b6a39178d84
          name: 'Unifi WLAN Guest Client'
          type: DEPENDENT
          key: unifi.wlan.guest.client
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].num_guest'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
        -
          uuid: e2cd072b8d474221b63fbb94ffbc58fc
          name: 'Unifi WLAN Status'
          type: DEPENDENT
          key: unifi.wlan.status
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].status'
          master_item:
            key: unifi.health
          tags:
            -
              tag: Application
              value: Statistics
            -
              tag: Interface
              value: wlan
          triggers:
            -
              uuid: 54e4cd7e9fed4a4fbcca448fd3db166f
              expression: 'last(/Unifi Network/unifi.wlan.status,#3)<>"ok" and last(/Unifi Network/unifi.wlan.status,#3)<>"unknown"'
              name: 'Problem on WLAN'
              priority: HIGH
      discovery_rules:
        -
          uuid: 64ce7addc60d4cbc9be7b5273e387844
          name: 'Client Wired'
          type: DEPENDENT
          key: unifi.client.wired.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#WIRED}'
                value: ^true$
                formulaid: A
          item_prototypes:
            -
              uuid: 81359236dde240b2b93bf454b582d78a
              name: '{#NAME} DNS Record Enabled'
              type: DEPENDENT
              key: 'unifi.client.wired.dns.record.enabled[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''local_dns_record_enabled'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: ff20c984ecce49da8fe710ec73bca5c7
              name: '{#NAME} DNS Record'
              type: DEPENDENT
              key: 'unifi.client.wired.dns.record[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''local_dns_record'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 92ba3b76f1c742cdb895b9bf2ed4688a
              name: '{#NAME} Guest'
              type: DEPENDENT
              key: 'unifi.client.wired.guest[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''is_guest'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 65ac49f80f4c46b4af70961abd3b0d21
              name: '{#NAME} Hostname'
              type: DEPENDENT
              key: 'unifi.client.wired.hostname[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].hostname'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 2c2dae4fd9bd427f8b33d7dfcafacaa8
              name: '{#NAME} IP Fixed'
              type: DEPENDENT
              key: 'unifi.client.wired.ip.fixed[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''use_fixedip'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 23811edc9c594ef39cf4e2e8ce99596f
              name: '{#NAME} IP'
              type: DEPENDENT
              key: 'unifi.client.wired.ip[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].ip'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 7fc22e993e8f4862aec69a6b2585919d
              name: '{#NAME} Macaddress'
              type: DEPENDENT
              key: 'unifi.client.wired.mac[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].mac'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: da2f0cb1cce9420088d9b09eaa6afde8
              name: '{#NAME} Network'
              type: DEPENDENT
              key: 'unifi.client.wired.network[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].network'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 1f6b50c2477f44e49247e8e8c18941b4
              name: '{#NAME} First Seen'
              type: DEPENDENT
              key: 'unifi.client.wired.seen.first[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: unixtime
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''first_seen'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 8e70b0a42dd344bd89d6d853376c2fd4
              name: '{#NAME} Last Seen'
              type: DEPENDENT
              key: 'unifi.client.wired.seen.last[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: unixtime
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''last_seen'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 4222829863d449f590253f00affec2e3
              name: '{#NAME} Wired Switch Depth'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.depth[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''sw_depth'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: e55881bebd0c464d916e14b63d743e3b
              name: '{#NAME} Wired Switch Port Macaddress'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.mac[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''sw_mac'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 9eb8c0adbc3441189904567ba325cc82
              name: '{#NAME} Wired Switch Port Total rx Retries'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.rx.bytes.r[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-rx_bytes-r'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: e46b8d77bcc94ad6aef47e6501c0b549
              name: '{#NAME} Wired Switch Port Total rx'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.rx.bytes[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-rx_bytes'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 0bb4370155fd4a688f7314c1d6a165f3
              name: '{#NAME} Wired Switch Port Total rx'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.rx.packets[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-rx_packets'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: f35db62c68724deeba3d733891405d7c
              name: '{#NAME} Wired Switch Port Speed'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.speed[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired_rate_mbps'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: b761a6ee8f3d418b9c179a4a836b8cbe
              name: '{#NAME} Wired Switch Port Total tx Retries'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.tx.bytes.r[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-tx_bytes-r'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 89789cae334740f0ae0f5dc82e796bc0
              name: '{#NAME} Wired Switch Port Total tx'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.tx.bytes[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-tx_bytes'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: c56efa9ccc5a40698d9a3f715d60a0fd
              name: '{#NAME} Wired Switch Port Total tx'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port.tx.packets[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''wired-tx_packets'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 747d2beef7bd414594ef63591dfb702d
              name: '{#NAME} Wired Switch Port'
              type: DEPENDENT
              key: 'unifi.client.wired.sw.port[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''sw_port'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 22dd209b97024a94afb023fc6eb492cc
              name: '{#NAME} Uptime'
              type: DEPENDENT
              key: 'unifi.client.wired.uptime[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: s
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].uptime'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 3fed4c221ab240bcbcdd685c3e986924
              name: '{#NAME} Vlan'
              type: DEPENDENT
              key: 'unifi.client.wired.vlan[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''gw_vlan'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
          master_item:
            key: unifi.client
          lld_macro_paths:
            -
              lld_macro: '{#MAC}'
              path: $.mac
            -
              lld_macro: '{#NAME}'
              path: $.name
            -
              lld_macro: '{#WIRED}'
              path: $.is_wired
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.data
        -
          uuid: 2641227a01cc4265a5be5e0f0a84211d
          name: 'Client Wireless'
          type: DEPENDENT
          key: unifi.client.wireless.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#WIRED}'
                value: ^false$
                formulaid: A
          item_prototypes:
            -
              uuid: c33bfac340764232814c75da1962db4d
              name: '{#NAME} Wireless AP bssid'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.bssid[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].bssid'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: dad619b2d09c454b8b1077f000ddca6b
              name: '{#NAME} Wireless AP Channel'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.channel[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].channel'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 64b3abf5b7aa4ded97e99bb868a843bb
              name: '{#NAME} Wireless AP essid'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.essid[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].essid'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: f8d4f9349e7e4de7b756e434eca53eb0
              name: '{#NAME} Wireless AP Macaddress'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.mac[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''ap_mac'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 5d2156d29e6c4bf89c8163decaf240c3
              name: '{#NAME} Wireless powersave'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.powersave[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''powersave_enabled'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: b858b40518074390a3e5b01a6a3addb0
              name: '{#NAME} Wireless AP Radio'
              type: DEPENDENT
              key: 'unifi.client.wireless.ap.radio[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].radio'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: e7a55e075ed24423bcc36c521bc9beef
              name: '{#NAME} DNS Record Enabled'
              type: DEPENDENT
              key: 'unifi.client.wireless.dns.record.enabled[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''local_dns_record_enabled'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: f34ce26d42aa4bc98f720da831caf449
              name: '{#NAME} DNS Record'
              type: DEPENDENT
              key: 'unifi.client.wireless.dns.record[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''local_dns_record'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: fdf2e5f46ea94ab3a0a46990ad398226
              name: '{#NAME} Guest'
              type: DEPENDENT
              key: 'unifi.client.wireless.guest[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''is_guest'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: b793fd9ec0f9470fa4a34da017cbef3a
              name: '{#NAME} Hostname'
              type: DEPENDENT
              key: 'unifi.client.wireless.hostname[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].hostname'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: ad3acc59db2647e788b934018d0a05e4
              name: '{#NAME} IP Fixed'
              type: DEPENDENT
              key: 'unifi.client.wireless.ip.fixed[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''use_fixedip'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 2be2b34a5851470db5861d39567b3452
              name: '{#NAME} IP'
              type: DEPENDENT
              key: 'unifi.client.wireless.ip[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].ip'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 42acb58ef395496abfc223a8cde818f5
              name: '{#NAME} Macaddress'
              type: DEPENDENT
              key: 'unifi.client.wireless.mac[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].mac'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 20d8b796766f4af0b868a98792e58ea4
              name: '{#NAME} Network'
              type: DEPENDENT
              key: 'unifi.client.wireless.network[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].network'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: b09965b2294b4752a0c1b13e94ef056e
              name: '{#NAME} Wireless Noise'
              type: DEPENDENT
              key: 'unifi.client.wireless.noise[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].noise'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 3586fae8be4641dba1ef6ebb54df8e24
              name: '{#NAME} Wireless Total rx Retries'
              type: DEPENDENT
              key: 'unifi.client.wireless.rx.bytes.r[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''rx_bytes-r'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: d31e62fd92744a35b7a40fe2e59aa918
              name: '{#NAME} Wireless Total rx'
              type: DEPENDENT
              key: 'unifi.client.wireless.rx.bytes[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''rx_bytes'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: d94b743fc4dd46d98a0978e6af03d5d6
              name: '{#NAME} Wireless Total rx'
              type: DEPENDENT
              key: 'unifi.client.wireless.rx.packets[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''rx_packets'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 1a83c4b8bb424a78ad37c8538163f197
              name: '{#NAME} Wireless rx rate'
              type: DEPENDENT
              key: 'unifi.client.wireless.rx.rates[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''rx_rate'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: c2942e1581074568b600886cf0bca485
              name: '{#NAME} First Seen'
              type: DEPENDENT
              key: 'unifi.client.wireless.seen.first[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: unixtime
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''first_seen'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 1c866132e9be443884734132123a1a75
              name: '{#NAME} Last Seen'
              type: DEPENDENT
              key: 'unifi.client.wireless.seen.last[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: unixtime
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''last_seen'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: aba77fec5fba4677926c707f5d3aca07
              name: '{#NAME} Wireless Signal'
              type: DEPENDENT
              key: 'unifi.client.wireless.signal[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].signal'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: a2727644922f4c388ca6de96f7dcc481
              name: '{#NAME} Wireless Total tx Retries'
              type: DEPENDENT
              key: 'unifi.client.wireless.tx.bytes.r[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''tx_bytes-r'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: bc7f55e613c34f0fa9c5e17bde81c9dd
              name: '{#NAME} Wireless Total tx'
              type: DEPENDENT
              key: 'unifi.client.wireless.tx.bytes[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''tx_bytes'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: ebfa2bc0ef8446eb92a0de3f24a6ff88
              name: '{#NAME} Wireless Total tx'
              type: DEPENDENT
              key: 'unifi.client.wireless.tx.packets[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''tx_packets'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 28ee35c5750e4b10bd39dc4f4d72161b
              name: '{#NAME} Wireless tx rate'
              type: DEPENDENT
              key: 'unifi.client.wireless.tx.rates[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''tx_rate'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 3a1bbc1952724a8885bec61622f50c5e
              name: '{#NAME} Uptime'
              type: DEPENDENT
              key: 'unifi.client.wireless.uptime[{#MAC}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: s
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')].uptime'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
            -
              uuid: 3c65b9564f6944eb86187243ff5e1cd4
              name: '{#NAME} Vlan'
              type: DEPENDENT
              key: 'unifi.client.wireless.vlan[{#MAC}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[?(@.mac==''{#MAC}'')][''gw_vlan'']'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.client
          master_item:
            key: unifi.client
          lld_macro_paths:
            -
              lld_macro: '{#MAC}'
              path: $.mac
            -
              lld_macro: '{#NAME}'
              path: $.name
            -
              lld_macro: '{#WIRED}'
              path: $.is_wired
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.data
        -
          uuid: 207a7dd740fb47338976131d64e14902
          name: 'Device UAP'
          type: DEPENDENT
          key: unifi.device.uap.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: ^uap$
                formulaid: A
          host_prototypes:
            -
              uuid: a18dfe793c104fe491e1882d088b8aea
              host: 'Unifi UAP {#NAME}'
              name: 'Unifi UAP {#NAME}'
              group_links:
                -
                  group:
                    name: Network
              templates:
                -
                  name: 'Unifi UAP'
              macros:
                -
                  macro: '{$UNIFI.UAP.MAC}'
                  value: '{#MAC}'
          master_item:
            key: unifi.device
          lld_macro_paths:
            -
              lld_macro: '{#MAC}'
              path: $.mac
            -
              lld_macro: '{#MODEL}'
              path: $.model
            -
              lld_macro: '{#NAME}'
              path: $.name
            -
              lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.data
        -
          uuid: c1f5615fd2ab438e9ecaf86fcf8e206d
          name: 'Device UDM'
          type: DEPENDENT
          key: unifi.device.udm.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: ^udm$
                formulaid: A
          host_prototypes:
            -
              uuid: 07b84b8225604f868abf6850eb330965
              host: 'Unifi UDM {#NAME}'
              name: 'Unifi UDM {#NAME}'
              group_links:
                -
                  group:
                    name: Network
              templates:
                -
                  name: 'Unifi UDM'
              macros:
                -
                  macro: '{$UNIFI.UDM.MAC}'
                  value: '{#MAC}'
          master_item:
            key: unifi.device
          lld_macro_paths:
            -
              lld_macro: '{#MAC}'
              path: $.mac
            -
              lld_macro: '{#MODEL}'
              path: $.model
            -
              lld_macro: '{#NAME}'
              path: $.name
            -
              lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.data
        -
          uuid: 35516fc7990345448be22136df815fa2
          name: 'Device USW'
          type: DEPENDENT
          key: unifi.device.usw.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: ^usw$
                formulaid: A
          host_prototypes:
            -
              uuid: 15ceef758cbe4fccb3eb205335a7c60d
              host: 'Unifi USW {#NAME}'
              name: 'Unifi USW {#NAME}'
              group_links:
                -
                  group:
                    name: Network
              templates:
                -
                  name: 'Unifi USW'
              macros:
                -
                  macro: '{$UNIFI.USW.MAC}'
                  value: '{#MAC}'
          master_item:
            key: unifi.device
          lld_macro_paths:
            -
              lld_macro: '{#MAC}'
              path: $.mac
            -
              lld_macro: '{#MODEL}'
              path: $.model
            -
              lld_macro: '{#NAME}'
              path: $.name
            -
              lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.data
      macros:
        -
          macro: '{$UNIFI.AP.DISCONNECTED.SEC}'
          value: '900'
          description: 'AP Disconnected Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.AP.PENDING.SEC}'
          value: '1800'
          description: 'AP Pending Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH}'
          value: '90'
          description: 'Cpu % High Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Cpu High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING}'
          value: '80'
          description: 'Cpu % Warning Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Cpu Warning Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.IP}'
          description: 'Unifi Ip'
        -
          macro: '{$UNIFI.ISP.LATENCY.HIGH}'
          value: '30'
          description: 'ISP ms High Trigger threshold'
        -
          macro: '{$UNIFI.ISP.LATENCY.HIGH.SEC}'
          value: '900'
          description: 'ISP  High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.ISP.LATENCY.WARNING}'
          value: '15'
          description: 'ISP ms Warning Trigger threshold'
        -
          macro: '{$UNIFI.ISP.LATENCY.WARNING.SEC}'
          value: '900'
          description: 'ISP  Warning Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.ISP.SPEED.DOWNLOAD}'
          value: '1000'
          description: 'ISP Max Download Speed in Mbps'
        -
          macro: '{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH}'
          value: '95'
          description: 'ISP Download % High Trigger threshold'
        -
          macro: '{$UNIFI.ISP.SPEED.DOWNLOAD.HIGH.SEC}'
          value: '900'
          description: 'ISP Download Avg High Trigger threshold in seconds'
        -
          macro: '{$UNIFI.ISP.SPEED.DOWNLOAD.WARNING}'
          value: '85'
          description: 'ISP Download % Warning Trigger threshold'
        -
          macro: '{$UNIFI.ISP.SPEED.DOWNLOAD.WARNING.SEC}'
          value: '900'
          description: 'ISP Download Avg Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.ISP.SPEED.UPLOAD}'
          value: '250'
          description: 'ISP Max Upload Speed in Mbps'
        -
          macro: '{$UNIFI.ISP.SPEED.UPLOAD.HIGH}'
          value: '85'
          description: 'ISP Upload % High Trigger threshold'
        -
          macro: '{$UNIFI.ISP.SPEED.UPLOAD.HIGH.SEC}'
          value: '900'
          description: 'ISP Upload Avg High Trigger threshold in seconds'
        -
          macro: '{$UNIFI.ISP.SPEED.UPLOAD.WARNING}'
          value: '95'
          description: 'ISP Upload % Warning Trigger threshold'
        -
          macro: '{$UNIFI.ISP.SPEED.UPLOAD.WARNING.SEC}'
          value: '900'
          description: 'ISP Upload Avg Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH}'
          value: '90'
          description: 'Memory % High Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Memory High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING}'
          value: '80'
          description: 'Memory % Warning Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Memory Warning Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.PASSWORD}'
          type: SECRET_TEXT
          description: 'Unifi View Only Password'
        -
          macro: '{$UNIFI.SW.DISCONNECTED.SEC}'
          value: '900'
          description: 'SW Disconnected Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.SW.PENDING.SEC}'
          value: '1800'
          description: 'SW Pending Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.USERNAME}'
          description: 'Unifi View Only Username'
        -
          macro: '{$UNIFI.API.AUTH.URI}'
          description: 'Unifi Authentication API (if using unifi controller vm set to api/login)'
          value: 'api/auth/login'
        -
          macro: '{$UNIFI.API.AUTH.TOKEN}'
          description: 'Unifi Authentication Token name (if using unifi controller vm set to unifises)'
          value: 'TOKEN'
        -
          macro: '{$UNIFI.API.URI}'
          description: 'Unifi API (if using unifi controller vm set to api/s/default/stat)'
          value: 'proxy/network/api/s/default/stat'
    -
      uuid: 1f35116bbdf84b7692a7ecc7273aede5
      template: 'Unifi UAP'
      name: 'Unifi UAP'
      description: 'This template use Unifi Dream Machine API for fetch data. API Wiki: https://ubntwiki.com/products/software/unifi-controller/api'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: c1cc91c462f14555969495e2ee9cf131
          name: 'UAP Adopted'
          type: DEPENDENT
          key: unifi.uap.adopted
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].adopted'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: ab791c5c28014fdd9c44286a06f818b9
              expression: 'last(/Unifi UAP/unifi.uap.adopted)<>"true"'
              name: 'AP Not Adopted'
              priority: INFO
        -
          uuid: 70c6b36d430248bb923e51434ee3354f
          name: 'UAP State'
          type: DEPENDENT
          key: unifi.uap.cpu.state
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].state'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Application
              value: metrics
          triggers:
            -
              uuid: 53ae565ef7d443238eb7ca686826640f
              expression: 'last(/Unifi UAP/unifi.uap.cpu.state,#3)<>1'
              name: 'AP Offline'
              priority: HIGH
        -
          uuid: f6c524d068bc4cb0b552400236c2ee4b
          name: 'UAP Cpu Usage %'
          type: DEPENDENT
          key: unifi.uap.cpu.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].cpu'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Application
              value: cpu
          triggers:
            -
              uuid: a5f1b9c226b14292ac78ced7b60414da
              expression: 'avg(/Unifi UAP/unifi.uap.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 6d6413f3d85741e6a05112bd7a778fcb
              expression: 'avg(/Unifi UAP/unifi.uap.cpu.usage,{$UNIFI.CPU.USAGE.WARNING.SEC})>{$UNIFI.CPU.USAGE.WARNING}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
                  expression: 'avg(/Unifi UAP/unifi.uap.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
        -
          uuid: 643eebfdd1ce4082af85e1e9700987d0
          name: 'API stat/device/{$UNIFI.UAP.MAC}'
          type: HTTP_AGENT
          key: unifi.uap.device
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/device/{$UNIFI.UAP.MAC}';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
        -
          uuid: 5aa198a9748a4c9198f5046bec671571
          name: 'UAP Inform Ip'
          type: DEPENDENT
          key: unifi.uap.inform.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_ip'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 36fae4ff63634e1abf8f5609aea7e930
          name: 'UAP Inform Url'
          type: DEPENDENT
          key: unifi.uap.inform.url
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_url'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 75ae4f27fb954d1e86fbc4447438f0d8
              expression: 'last(/Unifi UAP/unifi.uap.inform.url,#1:now-24h)<>last(/Unifi UAP/unifi.uap.inform.url,#1)=1'
              name: 'Inform Url Changed'
              priority: WARNING
        -
          uuid: bb0e894fa3874422ac8401b4df5e78aa
          name: 'UAP IP'
          type: DEPENDENT
          key: unifi.uap.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].name'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 7e6609d049dc4f978802ef11d0df1ab1
          name: 'UAP Kernel Version'
          type: DEPENDENT
          key: unifi.uap.kernel.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].kernel_version'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 3d5fdde7c5b3467cab0d8b892289e7ba
          name: 'UAP Last Seen'
          type: DEPENDENT
          key: unifi.uap.lastseen
          delay: '0'
          history: 7d
          trends: 90d
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_seen'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Application
              value: metrics
        -
          uuid: a99a35537c0342b781c27bf6f02b53ab
          name: 'UAP Macaddress'
          type: DEPENDENT
          key: unifi.uap.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].mac'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 4af3c4e027fb4f5f9e44188674c5569a
          name: 'UAP Memory Usage %'
          type: DEPENDENT
          key: unifi.uap.memory.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].mem'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Application
              value: memory
          triggers:
            -
              uuid: 2eca8e64ff3b4c80837940ac05f4a9ca
              expression: 'avg(/Unifi UAP/unifi.uap.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: f09d5efc87574249aff274b3a7adc0c1
              expression: 'avg(/Unifi UAP/unifi.uap.memory.usage,{$UNIFI.MEMORY.USAGE.WARNING.SEC})>{$UNIFI.MEMORY.USAGE.WARNING}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
                  expression: 'avg(/Unifi UAP/unifi.uap.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
        -
          uuid: bb2fa75fc8e24d19a4e7e804fbceff5d
          name: 'UAP Model'
          type: DEPENDENT
          key: unifi.uap.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].model'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 3965eea5addf431b9f301bdf08f0ea21
          name: 'UAP Management Network'
          type: DEPENDENT
          key: unifi.uap.network
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].connection_network_name'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: bb281e592293409ca1b06183f56f5021
              expression: 'last(/Unifi UAP/unifi.uap.network,#1:now-24h)<>last(/Unifi UAP/unifi.uap.network,#1)=1'
              name: 'Management Network Changed'
              priority: WARNING
        -
          uuid: 93436fb3e87c4643a78c69f1e9529fdb
          name: 'UAP Total RX Byte'
          type: DEPENDENT
          key: unifi.uap.rx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].rx_bytes'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: fc9c8357d22741ac99ad306a13ae7296
          name: 'UAP Serial'
          type: DEPENDENT
          key: unifi.uap.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].serial'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 8347a611d2854fa1b2e94740cd8a1c59
          name: 'UAP SOC Arch'
          type: DEPENDENT
          key: unifi.uap.soc.arch
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].architecture'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: f9fe51202c5442ad89edc8039419ce6c
          name: 'UAP Total TX Byte'
          type: DEPENDENT
          key: unifi.uap.tx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].tx_bytes'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: efa9f273f6f34229987caba2ee52afeb
          name: 'UAP Upgradable'
          type: DEPENDENT
          key: unifi.uap.upgradable
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].upgradable'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: a86112765c634417bd37318f06e74dfb
              expression: 'last(/Unifi UAP/unifi.uap.upgradable)="true"'
              name: 'Software Upgrade Available'
              priority: WARNING
        -
          uuid: 8b7d8cbd2d2745e3ab22d78f12d11f76
          name: 'UAP Uplink Device'
          type: DEPENDENT
          key: unifi.uap.uplink.device
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.uplink_device_name'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 4c67beb2f7d8417482029c6b747616c3
          name: 'UAP Uplink Port'
          type: DEPENDENT
          key: unifi.uap.uplink.port
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.uplink_remote_port'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 52163a08e934495992192956e595f997
          name: 'UAP Uplink Type'
          type: DEPENDENT
          key: unifi.uap.uplink.type
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.type'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 367a5272bf6a46c6ab6e31928be77657
          name: 'UAP Uptime'
          type: DEPENDENT
          key: unifi.uap.uptime
          delay: '0'
          history: 7d
          trends: 90d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].uptime'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: d851cdf588f34a3784c93724fabdb0ca
              expression: 'last(/Unifi UAP/unifi.uap.uptime)<1800'
              name: 'AP Rebooted'
              priority: WARNING
        -
          uuid: 78a283e4d2af4f299099ce66adf0e02a
          name: 'UAP Version'
          type: DEPENDENT
          key: unifi.uap.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].version'
          master_item:
            key: unifi.uap.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 654272398a95497881e1715321e03c1f
              expression: 'last(/Unifi UAP/unifi.uap.version,#1:now-24h)<>last(/Unifi UAP/unifi.uap.version,#1)=1'
              name: 'Software Version Changed'
              priority: INFO
      discovery_rules:
        -
          uuid: 76864c0422aa420b98433cd35765bb04
          name: Radio
          type: DEPENDENT
          key: unifi.uap.radio.discovery
          delay: '0'
          item_prototypes:
            -
              uuid: 7a68ecc1cbc640ef919dac3e1a9d4de1
              name: '{#NAME} Channel'
              type: DEPENDENT
              key: 'unifi.uap.radio.channel[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].channel'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 5e5615d6e853473cbabfb5df13f8385c
              name: '{#NAME} Gain'
              type: DEPENDENT
              key: 'unifi.uap.radio.gain[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: db
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].gain'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: ee872f1ef6734ad0b5ed80c66a2e7fca
              name: '{#NAME} HT'
              type: DEPENDENT
              key: 'unifi.uap.radio.ht[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table[?(@.name==''{#NAME}'')].ht'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: dbababc0fca94e9eb265822152e36ace
              name: '{#NAME} Radio'
              type: DEPENDENT
              key: 'unifi.uap.radio.radio[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].radio'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 9652ed38b77845c7b83d8c3986b06279
              name: '{#NAME} State'
              type: DEPENDENT
              key: 'unifi.uap.radio.state[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].state'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
              trigger_prototypes:
                -
                  uuid: a164c10e31234006a01ea127decdf5e9
                  expression: 'last(/Unifi UAP/unifi.uap.radio.state[{#NAME}],#3)<>"RUN"'
                  name: '{#NAME} State is not RUN'
                  priority: HIGH
            -
              uuid: 63917a470bbd44c7beba700c275e4774
              name: '{#NAME} TX Packets'
              type: DEPENDENT
              key: 'unifi.uap.radio.tx.packets[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].tx_packets'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: ae928b7aa4fe4e0abc89911d2e4067ee
              name: '{#NAME} TX Power Mode'
              type: DEPENDENT
              key: 'unifi.uap.radio.tx.power.mode[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table[?(@.name==''{#NAME}'')].tx_power_mode'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 0093955e56574d0ca5a64590019c59f3
              name: '{#NAME} TX Power'
              type: DEPENDENT
              key: 'unifi.uap.radio.tx.power[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: db
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].tx_power'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 12492c7b4c45464eb2bfdfbd9990969d
              name: '{#NAME} TX Retries'
              type: DEPENDENT
              key: 'unifi.uap.radio.tx.retries[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].radio_table_stats[?(@.name==''{#NAME}'')].tx_retries'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.uap.device
              tags:
                -
                  tag: Application
                  value: metrics
          master_item:
            key: unifi.uap.device
          lld_macro_paths:
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].radio_table_stats'
      macros:
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH}'
          value: '90'
          description: 'Cpu % High Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Cpu High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING}'
          value: '80'
          description: 'Cpu % Warning Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Cpu % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.IP}'
          description: 'Unifi Ip'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH}'
          value: '95'
          description: 'Memory % High Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Memory % High Trigger threshold in seconds'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING}'
          value: '85'
          description: 'Memory % Warning Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Memory % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.PASSWORD}'
          type: SECRET_TEXT
          description: 'Unifi View Only Password'
        -
          macro: '{$UNIFI.UAP.MAC}'
          description: 'UNIFI AP Macaddress'
        -
          macro: '{$UNIFI.USERNAME}'
          description: 'Unifi View Only Username'
        -
          macro: '{$UNIFI.API.AUTH.URI}'
          description: 'Unifi Authentication API (if using unifi controller vm set to api/login)'
          value: 'api/auth/login'
        -
          macro: '{$UNIFI.API.AUTH.TOKEN}'
          description: 'Unifi Authentication Token name (if using unifi controller vm set to unifises)'
          value: 'TOKEN'
        -
          macro: '{$UNIFI.API.URI}'
          description: 'Unifi API (if using unifi controller vm set to api/s/default/stat)'
          value: 'proxy/network/api/s/default/stat'
    -
      uuid: 69e05c254bc640908a3afc885beaaab8
      template: 'Unifi UDM'
      name: 'Unifi UDM'
      description: 'This template use Unifi Dream Machine API for fetch data. API Wiki: https://ubntwiki.com/products/software/unifi-controller/api'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: d39c022d1b80442795b112c532a67d6a
          name: 'UDM Adopted'
          type: DEPENDENT
          key: unifi.udm.adopted
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].adopted'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: cbb6cb96b7eb40db92d3cf31ebb11b38
              expression: 'last(/Unifi UDM/unifi.udm.adopted)<>"true"'
              name: 'GW Not Adopted'
              priority: INFO
        -
          uuid: fd8f638a0f514163910462c6fa0019bb
          name: 'UDM State'
          type: DEPENDENT
          key: unifi.udm.cpu.state
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].state'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Application
              value: metrics
          triggers:
            -
              uuid: 2a87ba16307943d386fe09a6d2916864
              expression: 'last(/Unifi UDM/unifi.udm.cpu.state,#3)<>1'
              name: 'GW Offline'
              priority: HIGH
        -
          uuid: 85053946790d416a8aa8915777cfd98d
          name: 'UDM Cpu Usage %'
          type: DEPENDENT
          key: unifi.udm.cpu.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].cpu'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Application
              value: cpu
          triggers:
            -
              uuid: cc8409dd2d424c7482d91dace993fdf6
              expression: 'avg(/Unifi UDM/unifi.udm.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 93c2d2a833e44ef0ba02c1e0012bebf8
              expression: 'avg(/Unifi UDM/unifi.udm.cpu.usage,{$UNIFI.CPU.USAGE.WARNING.SEC})>{$UNIFI.CPU.USAGE.WARNING}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
                  expression: 'avg(/Unifi UDM/unifi.udm.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
        -
          uuid: 4166eda3fa734ad29f913965c30074ee
          name: 'API stat/device/{$UNIFI.UDM.MAC}'
          type: HTTP_AGENT
          key: unifi.udm.device
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/device/{$UNIFI.UDM.MAC}';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
        -
          uuid: 52a52e5c9470418fb721d2a5e2c1ec16
          name: 'UDM Inform Ip'
          type: DEPENDENT
          key: unifi.udm.inform.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_ip'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: a26ed5dc4ba6483bb5033c7d8d282d62
          name: 'UDM Inform Url'
          type: DEPENDENT
          key: unifi.udm.inform.url
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_url'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 5daeca392871438984f90056da6c368d
              expression: 'last(/Unifi UDM/unifi.udm.inform.url,#1:now-24h)<>last(/Unifi UDM/unifi.udm.inform.url,#1)=1'
              name: 'Inform Url Changed'
              priority: WARNING
        -
          uuid: 0b75b0844da44aa4b9aaf8ec0a424003
          name: 'UDM IP'
          type: DEPENDENT
          key: unifi.udm.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].name'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 342044c581ee45f7b83af7855d1758d2
          name: 'UDM Kernel Version'
          type: DEPENDENT
          key: unifi.udm.kernel.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].kernel_version'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 8cabcc4d0ed34e0ea6a79425f074643c
          name: 'UDM Last Seen'
          type: DEPENDENT
          key: unifi.udm.lastseen
          delay: '0'
          history: 7d
          trends: 90d
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_seen'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Application
              value: metrics
        -
          uuid: e496e0ae76464d2c81fd40ba41a6f687
          name: 'UDM Macaddress'
          type: DEPENDENT
          key: unifi.udm.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].mac'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 7d5dea76e1c0478a8dbac9c31c2569be
          name: 'UDM Memory Usage %'
          type: DEPENDENT
          key: unifi.udm.memory.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].mem'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Application
              value: memory
          triggers:
            -
              uuid: 538eaf1de26c45cb98ead038f873ba0b
              expression: 'avg(/Unifi UDM/unifi.udm.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: bf2068af198f448dab9bfd08a952c932
              expression: 'avg(/Unifi UDM/unifi.udm.memory.usage,{$UNIFI.MEMORY.USAGE.WARNING.SEC})>{$UNIFI.MEMORY.USAGE.WARNING}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
                  expression: 'avg(/Unifi UDM/unifi.udm.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
        -
          uuid: e74617e39ac5497ca8a7e65d77437bbc
          name: 'UDM Model'
          type: DEPENDENT
          key: unifi.udm.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].model'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 8f5f6748fc414c12935fc91fc99b0962
          name: 'UDM Management Network'
          type: DEPENDENT
          key: unifi.udm.network
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].connection_network_name'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 080d2e1427d745f093e8d889ebc99409
              expression: 'last(/Unifi UDM/unifi.udm.network,#1:now-24h)<>last(/Unifi UDM/unifi.udm.network,#1)=1'
              name: 'Management Network Changed'
              priority: WARNING
        -
          uuid: ad81ca32a4e449b8a107893374197efc
          name: 'UDM Total RX Byte'
          type: DEPENDENT
          key: unifi.udm.rx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].rx_bytes'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 1dca3274195046c681a9228ba6687b20
          name: 'UDM Serial'
          type: DEPENDENT
          key: unifi.udm.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].serial'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: a198e227234b4c81a2dc328775810540
          name: 'UDM SOC Arch'
          type: DEPENDENT
          key: unifi.udm.soc.arch
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].architecture'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: faacb66c78ba405c8762aa58d0c3d1fa
          name: 'UDM Total TX Byte'
          type: DEPENDENT
          key: unifi.udm.tx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].tx_bytes'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 31042447a18e4f5692a14c4d492d641a
          name: 'UDM Upgradable'
          type: DEPENDENT
          key: unifi.udm.upgradable
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].upgradable'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 29b85f8d039d45c2974faee8a575b43f
              expression: 'last(/Unifi UDM/unifi.udm.upgradable)="true"'
              name: 'Software Upgrade Available'
              priority: WARNING
        -
          uuid: f7da60141314478789c18525ce925ed7
          name: 'UDM Uptime'
          type: DEPENDENT
          key: unifi.udm.uptime
          delay: '0'
          history: 7d
          trends: 90d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].uptime'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: c8f155ef14a349b2bf29db3a29c62024
              expression: 'last(/Unifi UDM/unifi.udm.uptime)<1800'
              name: 'GW Rebooted'
              priority: WARNING
        -
          uuid: b174b365f236400c97f27943503c1ab8
          name: 'UDM Version'
          type: DEPENDENT
          key: unifi.udm.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].version'
          master_item:
            key: unifi.udm.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 26f147aa61c5459d8dcbdc45046479eb
              expression: 'last(/Unifi UDM/unifi.udm.version,#1:now-24h)<>last(/Unifi UDM/unifi.udm.version,#1)=1'
              name: 'Software Version Changed'
              priority: INFO
      discovery_rules:
        -
          uuid: ef7084e956274f2eb29c5d0973b7e2aa
          name: Port
          type: DEPENDENT
          key: unifi.udm.port.discovery
          delay: '0'
          item_prototypes:
            -
              uuid: 95ed17a663e64fe1994c143271978034
              name: 'Port {#ID} Enabled'
              type: DEPENDENT
              key: 'unifi.udm.port.enabled[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].enable'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: e15f6ef584984b3ea0d6a9c2a689e932
              name: 'Port {#ID} Media'
              type: DEPENDENT
              key: 'unifi.udm.port.media[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].media'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: c14ed1ec0973407bb88160ee92269278
              name: 'Port {#ID} Mode'
              type: DEPENDENT
              key: 'unifi.udm.port.mode[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].op_mode'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: fe7f7bcfa23649d3adc6534165d79161
              name: 'Port {#ID} Name'
              type: DEPENDENT
              key: 'unifi.udm.port.name[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].name'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 929d7bbb312b4daa8c1b1a294fa17b69
              name: 'Port {#ID} POE Capable'
              type: DEPENDENT
              key: 'unifi.udm.port.poe.capable[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].port_poe'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: e97148420a5648e19543a211866b7beb
              name: 'Port {#ID} POE Good'
              type: DEPENDENT
              key: 'unifi.udm.port.poe.good[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_good'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 9cbcea5fee1e45038a7a3566d9b67474
              name: 'Port {#ID} POE Mode'
              type: DEPENDENT
              key: 'unifi.udm.port.poe.mode[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_mode'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 4b529d434cf1438983d20804484957a4
              name: 'Port {#ID} POE Power'
              type: DEPENDENT
              key: 'unifi.udm.port.poe.power[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              value_type: FLOAT
              units: W
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_power'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: f27cbaf39cfa4fcfa7678db82c08fc4e
              name: 'Port {#ID} Total RX Broadcast'
              type: DEPENDENT
              key: 'unifi.udm.port.rx.broadcast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_broadcast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: c40ef42024674ab0a84180d5888755cb
              name: 'Port {#ID} Total RX Dropped'
              type: DEPENDENT
              key: 'unifi.udm.port.rx.dropped[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_dropped'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: abfdbf4c0e4f4d8d83f186ac953f41fa
              name: 'Port {#ID} Total RX Errors'
              type: DEPENDENT
              key: 'unifi.udm.port.rx.errors[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_errors'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 47db89ca59b940d7b26613fa1c3c9b70
              name: 'Port {#ID} Total RX Multicast'
              type: DEPENDENT
              key: 'unifi.udm.port.rx.multicast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_multicast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 3a9ab245004b4bf9bd42e8062d7d956c
              name: 'Port {#ID} Total RX Packets'
              type: DEPENDENT
              key: 'unifi.udm.port.rx.packets[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_packets'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 0c5435ff234a414389412dfdf3c3671d
              name: 'Port {#ID} Total RX'
              type: DEPENDENT
              key: 'unifi.udm.port.rx[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_bytes'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: c77736ed30be417a9e22cc8d17240a6f
              name: 'Port {#ID} Speed'
              type: DEPENDENT
              key: 'unifi.udm.port.speed[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: bps
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].speed'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 56890ce345de46eeb9b2f106d492af46
              name: 'Port {#ID} Total TX Broadcast'
              type: DEPENDENT
              key: 'unifi.udm.port.tx.broadcast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_broadcast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 13ffae939bf7475e9df1e87ed7e84116
              name: 'Port {#ID} Total TX Dropped'
              type: DEPENDENT
              key: 'unifi.udm.port.tx.dropped[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_dropped'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 00dd5398b817479886c7759d5dce7258
              name: 'Port {#ID} Total TX Errors'
              type: DEPENDENT
              key: 'unifi.udm.port.tx.errors[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_errors'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 103aa40bb2914b0fb96fff5d71f7cd71
              name: 'Port {#ID} Total TX Multicast'
              type: DEPENDENT
              key: 'unifi.udm.port.tx.multicast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_multicast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: fadf5287030e4385a144316069e19405
              name: 'Port {#ID} Total TX Packets'
              type: DEPENDENT
              key: 'unifi.udm.port.tx.packets[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_packets'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 52d1ca247d10490f869724517e89c0b3
              name: 'Port {#ID} Total TX'
              type: DEPENDENT
              key: 'unifi.udm.port.tx[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_bytes'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 4ef70df5f4b546d49d99cc90abdf91a1
              name: 'Port {#ID} Up'
              type: DEPENDENT
              key: 'unifi.udm.port.up[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].up'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              tags:
                -
                  tag: Application
                  value: metrics
          master_item:
            key: unifi.udm.device
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.port_idx
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].port_table'
        -
          uuid: 593cf905e68e44d999c183ef182df831
          name: Temperatures
          type: DEPENDENT
          key: unifi.udm.temperature.discovery
          delay: '0'
          item_prototypes:
            -
              uuid: 2663bfe3cf37400e88a88f1df295fd9e
              name: 'Temperature {#NAME}'
              type: DEPENDENT
              key: 'udm.temperature[{#NAME}]'
              delay: '0'
              history: 7d
              trends: 90d
              value_type: FLOAT
              units: C
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].temperatures[?(@.name==''{#NAME}'')].value'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.udm.device
              trigger_prototypes:
                -
                  uuid: 05434280e4dc421997faecba2f58883d
                  expression: 'last(/Unifi UDM/udm.temperature[{#NAME}],{$UNIFI.TEMP.HIGH.SEC})>{$UNIFI.TEMP.HIGH}'
                  name: 'Temperature > {$UNIFI.TEMP.HIGH}'
                  priority: HIGH
                -
                  uuid: 2d034fb0f0f84210a1ce759b58b7a04a
                  expression: 'last(/Unifi UDM/udm.temperature[{#NAME}],{$UNIFI.TEMP.WARNING.SEC})>{$UNIFI.TEMP.WARNING}'
                  name: 'Temperature > {$UNIFI.TEMP.WARNING}'
                  priority: WARNING
                  dependencies:
                    -
                      name: 'Temperature > {$UNIFI.TEMP.HIGH}'
                      expression: 'last(/Unifi UDM/udm.temperature[{#NAME}],{$UNIFI.TEMP.HIGH.SEC})>{$UNIFI.TEMP.HIGH}'
          master_item:
            key: unifi.udm.device
          lld_macro_paths:
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].temperatures'
      macros:
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH}'
          value: '90'
          description: 'Cpu % High Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Cpu High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING}'
          value: '80'
          description: 'Cpu % Warning Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Cpu % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.IP}'
          description: 'Unifi Ip'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH}'
          value: '95'
          description: 'Memory % High Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Memory % High Trigger threshold in seconds'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING}'
          value: '85'
          description: 'Memory % Warning Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Memory % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.PASSWORD}'
          description: 'Unifi View Only Password'
        -
          macro: '{$UNIFI.TEMP.HIGH}'
          value: '80'
          description: 'Temperatire High Trigger threshold'
        -
          macro: '{$UNIFI.TEMP.HIGH.SEC}'
          value: '900'
          description: 'Temperatire High Trigger threshold in sec'
        -
          macro: '{$UNIFI.TEMP.WARNING}'
          value: '70'
          description: 'Temperatire Warning Trigger threshold'
        -
          macro: '{$UNIFI.TEMP.WARNING.SEC}'
          value: '900'
          description: 'Temperatire Warning Trigger threshold in sec'
        -
          macro: '{$UNIFI.UDM.MAC}'
          description: 'UNIFI GW Macaddress'
        -
          macro: '{$UNIFI.USERNAME}'
          description: 'Unifi View Only Username'
        -
          macro: '{$UNIFI.API.AUTH.URI}'
          description: 'Unifi Authentication API (if using unifi controller vm set to api/login)'
          value: 'api/auth/login'
        -
          macro: '{$UNIFI.API.AUTH.TOKEN}'
          description: 'Unifi Authentication Token name (if using unifi controller vm set to unifises)'
          value: 'TOKEN'
        -
          macro: '{$UNIFI.API.URI}'
          description: 'Unifi API (if using unifi controller vm set to api/s/default/stat)'
          value: 'proxy/network/api/s/default/stat'
    -
      uuid: 11395731205c44279ddd5b4d2152eacc
      template: 'Unifi USW'
      name: 'Unifi USW'
      description: 'This template use Unifi Dream Machine API for fetch data. API Wiki: https://ubntwiki.com/products/software/unifi-controller/api'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: c330362dba5b4034b36207dd5dfbc3a0
          name: 'USW Adopted'
          type: DEPENDENT
          key: unifi.usw.adopted
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].adopted'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: bc7bd414a7ba489abbdfca670f668577
              expression: 'last(/Unifi USW/unifi.usw.adopted)<>"true"'
              name: 'SW Not Adopted'
              priority: INFO
        -
          uuid: f18b6beb73bd45d2b12d5123b61c26b8
          name: 'USW State'
          type: DEPENDENT
          key: unifi.usw.cpu.state
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].state'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Application
              value: metrics
          triggers:
            -
              uuid: 4772da8f119d4705bee9c0b58182381f
              expression: 'last(/Unifi USW/unifi.usw.cpu.state,#3)<>1'
              name: 'SW Offline'
              priority: HIGH
        -
          uuid: 7fe7b0279bfe4b2d8a2f4dc18da3bf9b
          name: 'USW Cpu Usage %'
          type: DEPENDENT
          key: unifi.usw.cpu.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].cpu'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Application
              value: cpu
          triggers:
            -
              uuid: e046575a77944fa38ea5de5e47343d51
              expression: 'avg(/Unifi USW/unifi.usw.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 0656cf4350334b3680237b4c76125aee
              expression: 'avg(/Unifi USW/unifi.usw.cpu.usage,{$UNIFI.CPU.USAGE.WARNING.SEC})>{$UNIFI.CPU.USAGE.WARNING}'
              name: 'CPU Usage > {$UNIFI.CPU.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'CPU Usage > {$UNIFI.CPU.USAGE.HIGH}%'
                  expression: 'avg(/Unifi USW/unifi.usw.cpu.usage,{$UNIFI.CPU.USAGE.HIGH.SEC})>{$UNIFI.CPU.USAGE.HIGH}'
        -
          uuid: f3688c99e2874557b86b473e2b40a31b
          name: 'API stat/device/{$UNIFI.USW.MAC}'
          type: HTTP_AGENT
          key: unifi.usw.device
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - '{$UNIFI.API.AUTH.TOKEN}=([^;]+);'
                - \1
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      const url = 'https://{$UNIFI.IP}/{$UNIFI.API.URI}/device/{$UNIFI.USW.MAC}';
                  
                      request = new HttpRequest();
                      request.addHeader('Cookie: {$UNIFI.API.AUTH.TOKEN}='+value);
                  
                      response = request.get(url);
                      if (request.getStatus() != 200) {
                          throw 'Response code: '+request.getStatus();
                      }
                      response = JSON.parse(response);
                      return JSON.stringify(response);
                  } catch (error) {
                      Zabbix.log(4, '[Unifi Dream Machine Pro]: '+error);
                      return JSON.stringify({});
                  }
          timeout: 10s
          url: 'https://{$UNIFI.IP}/{$UNIFI.API.AUTH.URI}'
          posts: |
            {
                "username": "{$UNIFI.USERNAME}",
                "password": "{$UNIFI.PASSWORD}"
            }
          post_type: JSON
          retrieve_mode: BOTH
          request_method: POST
          output_format: JSON
          tags:
            -
              tag: Application
              value: raw
        -
          uuid: 1120571b081f4d22b8facdf9a282132f
          name: 'USW Inform Ip'
          type: DEPENDENT
          key: unifi.usw.inform.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_ip'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 70e405340adf40dd813a9c93dd8c11be
          name: 'USW Inform Url'
          type: DEPENDENT
          key: unifi.usw.inform.url
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].inform_url'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 2f2580a943d2486d9071f7b139a9ad0b
              expression: 'last(/Unifi USW/unifi.usw.inform.url,#1:now-24h)<>last(/Unifi USW/unifi.usw.inform.url,#1)=1'
              name: 'Inform Url Changed'
              priority: WARNING
        -
          uuid: f31e8ace549748069bd967a7fa900cb5
          name: 'USW IP'
          type: DEPENDENT
          key: unifi.usw.ip
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].name'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: c87a057c7ada4156bbb2079bbc1d566e
          name: 'USW Kernel Version'
          type: DEPENDENT
          key: unifi.usw.kernel.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].kernel_version'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: fe729c2805d24f5d90d82898be3f2c75
          name: 'USW Last Seen'
          type: DEPENDENT
          key: unifi.usw.lastseen
          delay: '0'
          history: 7d
          trends: 90d
          units: unixtime
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_seen'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Application
              value: metrics
        -
          uuid: b8b33025fb874413be3a1d76e02eadc2
          name: 'USW Macaddress'
          type: DEPENDENT
          key: unifi.usw.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].mac'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: c3ec97fcb610455a9ff2761ac04e74df
          name: 'USW Memory Usage %'
          type: DEPENDENT
          key: unifi.usw.memory.usage
          delay: '0'
          history: 7d
          trends: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].[''system-stats''].mem'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Application
              value: memory
          triggers:
            -
              uuid: b08d884b64ae4b3abd210f68410fa7d8
              expression: 'avg(/Unifi USW/unifi.usw.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
              priority: HIGH
            -
              uuid: 077fc55454ac4db8ab5f320789de1441
              expression: 'avg(/Unifi USW/unifi.usw.memory.usage,{$UNIFI.MEMORY.USAGE.WARNING.SEC})>{$UNIFI.MEMORY.USAGE.WARNING}'
              name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.WARNING}%'
              priority: WARNING
              dependencies:
                -
                  name: 'Memory Usage > {$UNIFI.MEMORY.USAGE.HIGH}%'
                  expression: 'avg(/Unifi USW/unifi.usw.memory.usage,{$UNIFI.MEMORY.USAGE.HIGH.SEC})>{$UNIFI.MEMORY.USAGE.HIGH}'
        -
          uuid: d350565833474d16bd3f4e2d3f4bd067
          name: 'USW Model'
          type: DEPENDENT
          key: unifi.usw.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].model'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 921f0a51346a40abba70938f1dfcf679
          name: 'USW Management Network'
          type: DEPENDENT
          key: unifi.usw.network
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].connection_network_name'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 52b3f2fd8f944ecbb5b61573bcc8fa92
              expression: 'last(/Unifi USW/unifi.usw.network,#1:now-24h)<>last(/Unifi USW/unifi.usw.network,#1)=1'
              name: 'Management Network Changed'
              priority: WARNING
        -
          uuid: d4aebf508dfb4ff3917743eb60fa65cf
          name: 'USW Total RX Byte'
          type: DEPENDENT
          key: unifi.usw.rx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].rx_bytes'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: d4ff96b87a514acc9191c4ff6fee3f65
          name: 'USW Serial'
          type: DEPENDENT
          key: unifi.usw.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].serial'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: f5c0a882c062405581ca260db1105a7f
          name: 'USW SOC Arch'
          type: DEPENDENT
          key: unifi.usw.soc.arch
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].architecture'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 52fbddcb32dc42d1adcccc9cec592d64
          name: 'USW Total TX Byte'
          type: DEPENDENT
          key: unifi.usw.tx
          delay: '0'
          history: 7d
          trends: 90d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].tx_bytes'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 42907d1baeee4562883adedeb4824cbd
          name: 'USW Upgradable'
          type: DEPENDENT
          key: unifi.usw.upgradable
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].upgradable'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 1101cb4053dc48eb955fa14c71d086cd
              expression: 'last(/Unifi USW/unifi.usw.upgradable)="true"'
              name: 'Software Upgrade Available'
              priority: WARNING
        -
          uuid: 41781a93bcbf4eb0aa4ea5303bbc7ac0
          name: 'USW Uplink Device'
          type: DEPENDENT
          key: unifi.usw.uplink.device
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.uplink_device_name'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: df89a8e3da004ea59cc244eaa351a66c
          name: 'USW Uplink Port'
          type: DEPENDENT
          key: unifi.usw.uplink.port
          delay: '0'
          history: 7d
          trends: 90d
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.uplink_remote_port'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: b8a393919007480099d2917f4757fd80
          name: 'USW Uplink Type'
          type: DEPENDENT
          key: unifi.usw.uplink.type
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].last_uplink.type'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
        -
          uuid: 4b0e3c9d49ac4321856dcd8fcd3f4afd
          name: 'USW Uptime'
          type: DEPENDENT
          key: unifi.usw.uptime
          delay: '0'
          history: 7d
          trends: 90d
          units: s
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].uptime'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: c98fbcebc09147c083c33a86fa6d5d96
              expression: 'last(/Unifi USW/unifi.usw.uptime)<1800'
              name: 'SW Rebooted'
              priority: WARNING
        -
          uuid: f70f7d43788144329a1b9332478170b7
          name: 'USW Version'
          type: DEPENDENT
          key: unifi.usw.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].version'
          master_item:
            key: unifi.usw.device
          tags:
            -
              tag: Appliaction
              value: metrics
          triggers:
            -
              uuid: 30bdbfdc446e47679da6154bd2f92439
              expression: 'last(/Unifi USW/unifi.usw.version,#1:now-24h)<>last(/Unifi USW/unifi.usw.version,#1)=1'
              name: 'Software Version Changed'
              priority: INFO
      discovery_rules:
        -
          uuid: 56f0444f742647da981de38eedd5639f
          name: Port
          type: DEPENDENT
          key: unifi.usw.port.discovery
          delay: '0'
          item_prototypes:
            -
              uuid: b544476c278f4f81849e99f0bc9941ce
              name: 'Port {#ID} Enabled'
              type: DEPENDENT
              key: 'unifi.usw.port.enabled[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].enable'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 0e170832efd44cd681d00a51511caefd
              name: 'Port {#ID} Media'
              type: DEPENDENT
              key: 'unifi.usw.port.media[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].media'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: ef0d5d40acb84e3e83d5aff407af4273
              name: 'Port {#ID} Mode'
              type: DEPENDENT
              key: 'unifi.usw.port.mode[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].op_mode'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 1c757ef558384ee696b3259fd5d7899d
              name: 'Port {#ID} Name'
              type: DEPENDENT
              key: 'unifi.usw.port.name[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].name'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: dbcf2c716bee4e8bb33eedca47da2ecc
              name: 'Port {#ID} POE Capable'
              type: DEPENDENT
              key: 'unifi.usw.port.poe.capable[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].port_poe'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 9819dc83ef2e4846b360ff2d5ffe9ce9
              name: 'Port {#ID} POE Good'
              type: DEPENDENT
              key: 'unifi.usw.port.poe.good[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_good'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: f3e0aafb994e44af9aa1df4ae877a080
              name: 'Port {#ID} POE Mode'
              type: DEPENDENT
              key: 'unifi.usw.port.poe.mode[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_mode'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: de5878fa96e7445bb43b47e13fb2ec87
              name: 'Port {#ID} POE Power'
              type: DEPENDENT
              key: 'unifi.usw.port.poe.power[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              value_type: FLOAT
              units: W
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].poe_power'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 2c36c0f9cef9418b9fd648ccd3990b35
              name: 'Port {#ID} Total RX Broadcast'
              type: DEPENDENT
              key: 'unifi.usw.port.rx.broadcast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_broadcast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: b3523434b4ab479688eebde93f1d3cc6
              name: 'Port {#ID} Total RX Dropped'
              type: DEPENDENT
              key: 'unifi.usw.port.rx.dropped[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_dropped'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: d51d0ef986fc4d14a0aa8a47f14fdd55
              name: 'Port {#ID} Total RX Errors'
              type: DEPENDENT
              key: 'unifi.usw.port.rx.errors[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_errors'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 5e454b614d2744ef91072662194f9ca2
              name: 'Port {#ID} Total RX Multicast'
              type: DEPENDENT
              key: 'unifi.usw.port.rx.multicast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_multicast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 2c8b91e8b2974d158653990b56b5f914
              name: 'Port {#ID} Total RX Packets'
              type: DEPENDENT
              key: 'unifi.usw.port.rx.packets[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_packets'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: a81ae2d31e0b44ecb0601ec4dd114ad9
              name: 'Port {#ID} Total RX'
              type: DEPENDENT
              key: 'unifi.usw.port.rx[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].rx_bytes'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: c0fdc2178bc147ccb164aac3d0b1e481
              name: 'Port {#ID} Speed'
              type: DEPENDENT
              key: 'unifi.usw.port.speed[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: bps
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].speed'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: ae3fe9733ba84c87b1d502e62b64995e
              name: 'Port {#ID} STP Cost'
              type: DEPENDENT
              key: 'unifi.usw.port.stp.cost[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].stp_pathcost'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: b02df1ecf3374cd0a71f973be62a624c
              name: 'Port {#ID} STP State'
              type: DEPENDENT
              key: 'unifi.usw.port.stp.state[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].stp_state'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: a3fb9dd501894177809a1f3fff91d2ad
              name: 'Port {#ID} Total TX Broadcast'
              type: DEPENDENT
              key: 'unifi.usw.port.tx.broadcast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_broadcast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 9444aa4c51d14f2da0a0a100441f3677
              name: 'Port {#ID} Total TX Dropped'
              type: DEPENDENT
              key: 'unifi.usw.port.tx.dropped[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_dropped'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 477cb78b95e34e789ec73f08828d0ca9
              name: 'Port {#ID} Total TX Errors'
              type: DEPENDENT
              key: 'unifi.usw.port.tx.errors[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_errors'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 8de2c238feea40638e5a810bce3aa03a
              name: 'Port {#ID} Total TX Multicast'
              type: DEPENDENT
              key: 'unifi.usw.port.tx.multicast[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_multicast'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: e0ad8bd5a8dd471eaa759e8d0e34315d
              name: 'Port {#ID} Total TX Packets'
              type: DEPENDENT
              key: 'unifi.usw.port.tx.packets[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: packets
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_packets'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 5c20741bb5a94b99ae9f6e55ad62cc90
              name: 'Port {#ID} Total TX'
              type: DEPENDENT
              key: 'unifi.usw.port.tx[{#ID}]'
              delay: '0'
              history: 7d
              trends: 90d
              units: B
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].tx_bytes'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
            -
              uuid: 682c761ecf84405c97514bea0c6f0a14
              name: 'Port {#ID} Up'
              type: DEPENDENT
              key: 'unifi.usw.port.up[{#ID}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$.data[0].port_table[?(@.port_idx==''{#ID}'')].up'
                -
                  type: JSONPATH
                  parameters:
                    - '$.[0]'
              master_item:
                key: unifi.usw.device
              tags:
                -
                  tag: Application
                  value: metrics
          master_item:
            key: unifi.usw.device
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.port_idx
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.data[0].port_table'
      macros:
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH}'
          value: '90'
          description: 'Cpu % High Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Cpu High Trigger Avg threshold in seconds'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING}'
          value: '80'
          description: 'Cpu % Warning Trigger threshold'
        -
          macro: '{$UNIFI.CPU.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Cpu % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.IP}'
          description: 'Unifi Ip'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH}'
          value: '95'
          description: 'Memory % High Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.HIGH.SEC}'
          value: '900'
          description: 'Memory % High Trigger threshold in seconds'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING}'
          value: '85'
          description: 'Memory % Warning Trigger threshold'
        -
          macro: '{$UNIFI.MEMORY.USAGE.WARNING.SEC}'
          value: '900'
          description: 'Memory % Warning Trigger threshold in seconds'
        -
          macro: '{$UNIFI.PASSWORD}'
          type: SECRET_TEXT
          description: 'Unifi View Only Password'
        -
          macro: '{$UNIFI.USERNAME}'
          description: 'Unifi View Only Username'
        -
          macro: '{$UNIFI.API.AUTH.URI}'
          description: 'Unifi Authentication API (if using unifi controller vm set to api/login)'
          value: 'api/auth/login'
        -
          macro: '{$UNIFI.API.AUTH.TOKEN}'
          description: 'Unifi Authentication Token name (if using unifi controller vm set to unifises)'
          value: 'TOKEN'
        -
          macro: '{$UNIFI.API.URI}'
          description: 'Unifi API (if using unifi controller vm set to api/s/default/stat)'
          value: 'proxy/network/api/s/default/stat'
        -
          macro: '{$UNIFI.USW.MAC}'
          description: 'UNIFI SW Macaddress'
